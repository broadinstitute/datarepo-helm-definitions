---
global:
  applicationVersion: "mark-0.0.1"

gcloud-sqlproxy:
  enabled: true
  googleServiceAccount: ms-proxy-sa@broad-jade-dev.iam.gserviceaccount.com
  cloudsql:
    instances:
      # GCP instance name.
      - instance: "jade-postgres-11-8a00fd4d3b"
        # GCP project where the instance exists.
        project: "broad-jade-dev"
        # GCP region where the instance exists.
        region: "us-central1"
        # Port number for the proxy to expose for this instance.
        port: 5432
  rbac:
    create: true
  networkPolicy:
    enabled: false

datarepo-api:
  enabled: true
  env:
    GOOGLE_PROJECTID: broad-jade-dev
    GOOGLE_SINGLEDATAPROJECTID: broad-jade-ms-data
    GOOGLE_ALLOWREUSEEXISTINGBUCKETS: true
    GOOGLE_ALLOWREUSEEXISTINGPROJECTS: true
    DB_DATAREPO_USERNAME: drmanager
    SPRING_PROFILES_ACTIVE: google,cloudsql,dev,ms
    DB_STAIRWAY_USERNAME: drmanager
    DB_STAIRWAY_URI: jdbc:postgresql://ms-jade-gcloud-sqlproxy.ms:5432/stairway-ms
    DB_DATAREPO_URI: jdbc:postgresql://ms-jade-gcloud-sqlproxy.ms:5432/datarepo-ms
  serviceAccount:
    create: true
  rbac:
    create: true
    pspEnabled: true
  existingSecretDB: "database-pwd-ms"
  existingDatarepoDbSecretKey: "datarepopassword"
  existingStairwayDbSecretKey: "stairwaypassword"
  existingSecretSA: "jade-sa"
  existingServiceAccountSecretKey: "datareposerviceaccount"

datarepo-ui:
  enabled: true
  proxyPass:
    status: http://ms-jade-datarepo-api.ms:8080/status
    swagger: http://ms-jade-datarepo-api.ms:8080/swagger-ui.html
    shutdown: http://ms-jade-datarepo-api.ms:8080/shutdown
    api: http://ms-jade-datarepo-api.ms:8080
  serviceAccount:
    create: true
  rbac:
    create: true

oidc-proxy:
  enabled: true
  env:
    PROXY_URL: http://ms-jade-datarepo-ui.ms:8080/
    PROXY_URL2: http://ms-jade-datarepo-api.ms:8080/api
    PROXY_URL3: http://ms-jade-datarepo-api.ms:8080/register
    LOG_LEVEL: debug
    SERVER_NAME: jade.datarepo-dev.broadinstitute.org
    REMOTE_USER_CLAIM: sub
    ENABLE_STACKDRIVER: yes
    FILTER2: AddOutputFilterByType DEFLATE application/json text/plain text/html application/javascript application/x-javascript
  ingress:
    enabled: true
    domainName: jade-ms.datarepo-dev.broadinstitute.org
    annotations:
      kubernetes.io/ingress.global-static-ip-name: jade-dev-ms
    tls:
      - hosts:
          - jade-ms.datarepo-dev.broadinstitute.org
    paths:
      - /*
    hosts:
      - jade-ms.datarepo-dev.broadinstitute.org
  serviceAccount:
    create: true
  rbac:
    create: true
    pspEnabled: true

prometheus:
  enabled: true
  rbac:
    create: true
  podSecurityPolicy:
    enabled: true
  nodeExporter:
    podSecurityPolicy:
      enabled: true
  kube-state-metrics:
    podSecurityPolicy:
      enabled: true
grafana:
  enable: true
  rbac:
    create: true
    pspEnabled: true
  plugins: ["grafana-kubernetes-app","doitintl-bigquery-datasource"]
  env:
    GF_USERS_AUTO_ASSIGN_ORG_ROLE: "Editor"
    GF_AUTH_GOOGLE_ENABLED: "true"
    GF_AUTH_GOOGLE_ALLOW_SIGN_UP: "true"
    GF_AUTH_GOOGLE_CLIENT_ID: "970791974390-1581mjhtp2b3jmg4avhor1vabs13b7ur.apps.googleusercontent.com"
    GF_AUTH_GOOGLE_SCOPES: "https://www.googleapis.com/auth/userinfo.profile https://www.googleapis.com/auth/userinfo.email"
    GF_AUTH_GOOGLE_AUTH_URL: "https://accounts.google.com/o/oauth2/auth"
    GF_AUTH_GOOGLE_AUTH_TOKEN: "https://accounts.google.com/o/oauth2/token"
    GF_AUTH_GOOGLE_API_URL: "https://www.googleapis.com/oauth2/v1/userinfo"
    GF_AUTH_GOOGLE_ALLOWED_DOMAINS: "broadinstitute.org verily.com"
    GF_SERVER_DOMAIN: "grafana.datarepo-dev.broadinstitute.org"
    GF_SERVER_ROOT_URL: "grafana.datarepo-dev.broadinstitute.org"
  envFromSecret: "grafana-google-client-secret"
  datasources:
    datasources.yaml:
      apiVersion: 1
      datasources:
      - name: Prometheus
        type: prometheus
        url: http://monitoring-prometheus-server.monitoring:9090
        access: proxy
        isDefault: true
  service:
    type: NodePort
  ingress:
    enabled: true
    hosts:
      - grafana.datarepo-dev.broadinstitute.org
    annotations:
      kubernetes.io/ingress.global-static-ip-name: grafana-k8-100
      kubernetes.io/ingress.allow-http: "false"
      ingress.kubernetes.io/whitelist-source-range: "69.173.112.0/21,69.173.127.232/29,69.173.127.128/26,69.173.127.0/25,69.173.127.240/28,69.173.127.224/30,69.173.127.230/31,69.173.120.0/22,69.173.127.228/32,69.173.126.0/24,69.173.96.0/20,69.173.64.0/19,69.173.127.192/27,69.173.124.0/23"
    tls:
      - secretName: grafana-tls-key
        hosts:
          - grafana.datarepo-dev.broadinstitute.org
